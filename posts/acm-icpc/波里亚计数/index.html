<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>波里亚计数 | Hi-^_^</title><meta name=keywords content="POLYA,搬家"><meta name=description content="Polya计数 将波利亚计数定理整理在这里，作为一个总结和介绍，也方便以后复习
为什么学习Polya计数定理
通过Polya计数定理，我们可以计算等价类的数量，比如下面这个问题：
用$m$种颜色给一个正方形染色，如果正方形可以自由转动，求染色方案数
让我们从一些概念开始
1 等价关系 1.1 等价关系的定义 假设$V$是一个集合，$S$是定义在$V$上的一个关系，若$S$有如下性质：
自反性 传递性 对称性 那么， $S$就是一个等价关系
$a$和$b$有关系$S$,可以记为$aSb$
假设定义关系$S$，图形$a$可以旋转得到$b$ $\Leftrightarrow$ $aSb$
例如图中的$方块_1$和$方块_2$具有关系$S$，即他们可以通过旋转得到彼此，而$方块_1$和$方块_2$则没有关系$S$
1.2 等价类 通过上图，可以看出来：$方块_1$和$方块_2$是同一类的，而$方块_1$和$方块_2$则是另外两类，于是可以想到集合$V$上的等价关系$S$将集合的元素划分到不同的类中，我们把它称为等价类
而包含元素$a$的等价类则是由满足$aSb$的所有元素$b$组成的(当然也包含元素$a$),即$C(a)={b\in V | \ aSb}$
仔细想一想，不难发现两个不同等价类是不相交的
2 置换群 2.1 置换群的定义 假设$A={1,2,\dotsc, n}$，通过置换，将$A$中的元素重新排列，得到另一个排列$a_1, a_2, \dotsc, a_n$，可以把这个过程写成
$$ \left ( \begin{matrix} 1 & 2 & \dotsc & n \newline a_1 & a_2 & \dotsc & a_n \end{matrix} \right ) $$
所以，可以将置换看成一个双射函数$f:{1,2,\dotsc, n} \rightarrow {1,2,\dotsc, n}$
置换之间也可进行合成运算
$$ \pi_1 = \left ( \begin{matrix} 1 & 2 & 3 & 4 \newline 4 & 2 & 1 & 3 \end{matrix} \right ) \ \ \pi_2 = \left ( \begin{matrix} 1 & 2 & 3 & 4 \newline 2 & 1 & 4 & 3 \end{matrix} \right ) $$"><meta name=author content><link rel=canonical href=https://Anlarry.github.io/posts/acm-icpc/%E6%B3%A2%E9%87%8C%E4%BA%9A%E8%AE%A1%E6%95%B0/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.min.adc94f6a0b1f14123eb9f0e26177c35ba3040fa9e921e93741358a9d6c6a42e6.css integrity="sha256-rclPagsfFBI+ufDiYXfDW6MED6npIek3QTWKnWxqQuY=" rel="preload stylesheet" as=style><link rel=preload href=/icon/ai512.png as=image><link ref=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/atom-one-dark.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js></script>
<script>hljs.highlightAll()</script><link href='https://fonts.googleapis.com/css?family=Source Code Pro' rel=stylesheet><link rel=icon href=https://Anlarry.github.io/icon/ai512.png><link rel=icon type=image/png sizes=16x16 href=https://Anlarry.github.io/icon/ai16.png><link rel=icon type=image/png sizes=32x32 href=https://Anlarry.github.io/icon/ai32.png><link rel=apple-touch-icon href=https://Anlarry.github.io/apple-touch-icon.png><link rel=mask-icon href=https://Anlarry.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.105.0"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="波里亚计数"><meta property="og:description" content="Polya计数 将波利亚计数定理整理在这里，作为一个总结和介绍，也方便以后复习
为什么学习Polya计数定理
通过Polya计数定理，我们可以计算等价类的数量，比如下面这个问题：
用$m$种颜色给一个正方形染色，如果正方形可以自由转动，求染色方案数
让我们从一些概念开始
1 等价关系 1.1 等价关系的定义 假设$V$是一个集合，$S$是定义在$V$上的一个关系，若$S$有如下性质：
自反性 传递性 对称性 那么， $S$就是一个等价关系
$a$和$b$有关系$S$,可以记为$aSb$
假设定义关系$S$，图形$a$可以旋转得到$b$ $\Leftrightarrow$ $aSb$
例如图中的$方块_1$和$方块_2$具有关系$S$，即他们可以通过旋转得到彼此，而$方块_1$和$方块_2$则没有关系$S$
1.2 等价类 通过上图，可以看出来：$方块_1$和$方块_2$是同一类的，而$方块_1$和$方块_2$则是另外两类，于是可以想到集合$V$上的等价关系$S$将集合的元素划分到不同的类中，我们把它称为等价类
而包含元素$a$的等价类则是由满足$aSb$的所有元素$b$组成的(当然也包含元素$a$),即$C(a)={b\in V | \ aSb}$
仔细想一想，不难发现两个不同等价类是不相交的
2 置换群 2.1 置换群的定义 假设$A={1,2,\dotsc, n}$，通过置换，将$A$中的元素重新排列，得到另一个排列$a_1, a_2, \dotsc, a_n$，可以把这个过程写成
$$ \left ( \begin{matrix} 1 & 2 & \dotsc & n \newline a_1 & a_2 & \dotsc & a_n \end{matrix} \right ) $$
所以，可以将置换看成一个双射函数$f:{1,2,\dotsc, n} \rightarrow {1,2,\dotsc, n}$
置换之间也可进行合成运算
$$ \pi_1 = \left ( \begin{matrix} 1 & 2 & 3 & 4 \newline 4 & 2 & 1 & 3 \end{matrix} \right ) \ \ \pi_2 = \left ( \begin{matrix} 1 & 2 & 3 & 4 \newline 2 & 1 & 4 & 3 \end{matrix} \right ) $$"><meta property="og:type" content="article"><meta property="og:url" content="https://Anlarry.github.io/posts/acm-icpc/%E6%B3%A2%E9%87%8C%E4%BA%9A%E8%AE%A1%E6%95%B0/"><meta property="og:image" content="https://Anlarry.github.io/cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-14T00:46:00+08:00"><meta property="article:modified_time" content="2020-02-14T00:46:00+08:00"><meta property="og:site_name" content="Hi~, ^_^"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://Anlarry.github.io/cover.png"><meta name=twitter:title content="波里亚计数"><meta name=twitter:description content="Polya计数 将波利亚计数定理整理在这里，作为一个总结和介绍，也方便以后复习
为什么学习Polya计数定理
通过Polya计数定理，我们可以计算等价类的数量，比如下面这个问题：
用$m$种颜色给一个正方形染色，如果正方形可以自由转动，求染色方案数
让我们从一些概念开始
1 等价关系 1.1 等价关系的定义 假设$V$是一个集合，$S$是定义在$V$上的一个关系，若$S$有如下性质：
自反性 传递性 对称性 那么， $S$就是一个等价关系
$a$和$b$有关系$S$,可以记为$aSb$
假设定义关系$S$，图形$a$可以旋转得到$b$ $\Leftrightarrow$ $aSb$
例如图中的$方块_1$和$方块_2$具有关系$S$，即他们可以通过旋转得到彼此，而$方块_1$和$方块_2$则没有关系$S$
1.2 等价类 通过上图，可以看出来：$方块_1$和$方块_2$是同一类的，而$方块_1$和$方块_2$则是另外两类，于是可以想到集合$V$上的等价关系$S$将集合的元素划分到不同的类中，我们把它称为等价类
而包含元素$a$的等价类则是由满足$aSb$的所有元素$b$组成的(当然也包含元素$a$),即$C(a)={b\in V | \ aSb}$
仔细想一想，不难发现两个不同等价类是不相交的
2 置换群 2.1 置换群的定义 假设$A={1,2,\dotsc, n}$，通过置换，将$A$中的元素重新排列，得到另一个排列$a_1, a_2, \dotsc, a_n$，可以把这个过程写成
$$ \left ( \begin{matrix} 1 & 2 & \dotsc & n \newline a_1 & a_2 & \dotsc & a_n \end{matrix} \right ) $$
所以，可以将置换看成一个双射函数$f:{1,2,\dotsc, n} \rightarrow {1,2,\dotsc, n}$
置换之间也可进行合成运算
$$ \pi_1 = \left ( \begin{matrix} 1 & 2 & 3 & 4 \newline 4 & 2 & 1 & 3 \end{matrix} \right ) \ \ \pi_2 = \left ( \begin{matrix} 1 & 2 & 3 & 4 \newline 2 & 1 & 4 & 3 \end{matrix} \right ) $$"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://Anlarry.github.io/posts/"},{"@type":"ListItem","position":2,"name":"波里亚计数","item":"https://Anlarry.github.io/posts/acm-icpc/%E6%B3%A2%E9%87%8C%E4%BA%9A%E8%AE%A1%E6%95%B0/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"波里亚计数","name":"波里亚计数","description":"Polya计数 将波利亚计数定理整理在这里，作为一个总结和介绍，也方便以后复习\n为什么学习Polya计数定理\n通过Polya计数定理，我们可以计算等价类的数量，比如下面这个问题：\n用$m$种颜色给一个正方形染色，如果正方形可以自由转动，求染色方案数\n让我们从一些概念开始\n1 等价关系 1.1 等价关系的定义 假设$V$是一个集合，$S$是定义在$V$上的一个关系，若$S$有如下性质：\n自反性 传递性 对称性 那么， $S$就是一个等价关系\n$a$和$b$有关系$S$,可以记为$aSb$\n假设定义关系$S$，图形$a$可以旋转得到$b$ $\\Leftrightarrow$ $aSb$\n例如图中的$方块_1$和$方块_2$具有关系$S$，即他们可以通过旋转得到彼此，而$方块_1$和$方块_2$则没有关系$S$\n1.2 等价类 通过上图，可以看出来：$方块_1$和$方块_2$是同一类的，而$方块_1$和$方块_2$则是另外两类，于是可以想到集合$V$上的等价关系$S$将集合的元素划分到不同的类中，我们把它称为等价类\n而包含元素$a$的等价类则是由满足$aSb$的所有元素$b$组成的(当然也包含元素$a$),即$C(a)={b\\in V | \\ aSb}$\n仔细想一想，不难发现两个不同等价类是不相交的\n2 置换群 2.1 置换群的定义 假设$A={1,2,\\dotsc, n}$，通过置换，将$A$中的元素重新排列，得到另一个排列$a_1, a_2, \\dotsc, a_n$，可以把这个过程写成\n$$ \\left ( \\begin{matrix} 1 \u0026amp; 2 \u0026amp; \\dotsc \u0026amp; n \\newline a_1 \u0026amp; a_2 \u0026amp; \\dotsc \u0026amp; a_n \\end{matrix} \\right ) $$\n所以，可以将置换看成一个双射函数$f:{1,2,\\dotsc, n} \\rightarrow {1,2,\\dotsc, n}$\n置换之间也可进行合成运算\n$$ \\pi_1 = \\left ( \\begin{matrix} 1 \u0026amp; 2 \u0026amp; 3 \u0026amp; 4 \\newline 4 \u0026amp; 2 \u0026amp; 1 \u0026amp; 3 \\end{matrix} \\right ) \\ \\ \\pi_2 = \\left ( \\begin{matrix} 1 \u0026amp; 2 \u0026amp; 3 \u0026amp; 4 \\newline 2 \u0026amp; 1 \u0026amp; 4 \u0026amp; 3 \\end{matrix} \\right ) $$","keywords":["POLYA","搬家"],"articleBody":"Polya计数 将波利亚计数定理整理在这里，作为一个总结和介绍，也方便以后复习\n为什么学习Polya计数定理\n通过Polya计数定理，我们可以计算等价类的数量，比如下面这个问题：\n用$m$种颜色给一个正方形染色，如果正方形可以自由转动，求染色方案数\n让我们从一些概念开始\n1 等价关系 1.1 等价关系的定义 假设$V$是一个集合，$S$是定义在$V$上的一个关系，若$S$有如下性质：\n自反性 传递性 对称性 那么， $S$就是一个等价关系\n$a$和$b$有关系$S$,可以记为$aSb$\n假设定义关系$S$，图形$a$可以旋转得到$b$ $\\Leftrightarrow$ $aSb$\n例如图中的$方块_1$和$方块_2$具有关系$S$，即他们可以通过旋转得到彼此，而$方块_1$和$方块_2$则没有关系$S$\n1.2 等价类 通过上图，可以看出来：$方块_1$和$方块_2$是同一类的，而$方块_1$和$方块_2$则是另外两类，于是可以想到集合$V$上的等价关系$S$将集合的元素划分到不同的类中，我们把它称为等价类\n而包含元素$a$的等价类则是由满足$aSb$的所有元素$b$组成的(当然也包含元素$a$),即$C(a)={b\\in V | \\ aSb}$\n仔细想一想，不难发现两个不同等价类是不相交的\n2 置换群 2.1 置换群的定义 假设$A={1,2,\\dotsc, n}$，通过置换，将$A$中的元素重新排列，得到另一个排列$a_1, a_2, \\dotsc, a_n$，可以把这个过程写成\n$$ \\left ( \\begin{matrix} 1 \u0026 2 \u0026 \\dotsc \u0026 n \\newline a_1 \u0026 a_2 \u0026 \\dotsc \u0026 a_n \\end{matrix} \\right ) $$\n所以，可以将置换看成一个双射函数$f:{1,2,\\dotsc, n} \\rightarrow {1,2,\\dotsc, n}$\n置换之间也可进行合成运算\n$$ \\pi_1 = \\left ( \\begin{matrix} 1 \u0026 2 \u0026 3 \u0026 4 \\newline 4 \u0026 2 \u0026 1 \u0026 3 \\end{matrix} \\right ) \\ \\ \\pi_2 = \\left ( \\begin{matrix} 1 \u0026 2 \u0026 3 \u0026 4 \\newline 2 \u0026 1 \u0026 4 \u0026 3 \\end{matrix} \\right ) $$\n$$ \\pi_1 \\circ \\pi_2 =\\left ( \\begin{matrix} 1 \u0026 2 \u0026 3 \u0026 4 \\newline 2 \u0026 4 \u0026 3 \u0026 1 \\end{matrix} \\right ) $$ $\\pi_1 \\circ \\pi_2 (1) = \\pi_1(\\pi_2(1))=2$\n而在置换集合$X$上定义的群则称为置换群，置换群也是群也要满足群的性 质\n运算封闭 $\\pi_1 \\in X, \\pi_2 \\in X \\Rightarrow \\pi_1 \\circ \\pi_2 \\in X$ 满足结合律 有单位元，置换$I(a)=a$ 有逆元，$\\pi \\circ \\pi^{-1} = I$ 但是置换与计算不同染色模式数量有什么关系？图形的旋转等变换都可以用一个只置换来表示\n我们把1-4按顺时针放到正方形的四个方块中\n$\\pi_1=\\left(\\begin{matrix} 1 \u0026 2 \u0026 3 \u0026 4 \\newline 1 \u0026 2 \u0026 3 \u0026 4 \\end{matrix}\\right)$\n旋转$90^\\circ$\n$\\pi_2=\\left(\\begin{matrix} 1 \u0026 2 \u0026 3 \u0026 4 \\newline 4 \u0026 1 \u0026 2 \u0026 3 \\end{matrix}\\right)$\n2.2 置换群衍生的等价关系 假设$G=(X,\\circ)$，通过置换$\\pi\\in X$，元素$a$可以被置换为其他元素$\\pi(a)=b$，可以发现这里也存在一种等价关系， 可以定义等价关系$S$:\n$$ aSb \\Leftrightarrow \\exist \\pi \\in G, \\pi(a)=b $$\n$\\pi \\in G 也可以来表示 \\pi \\in X$\n而包含$a$的等价类$C(a)$是由所有满足$aSb$的元素$b$组成的，因此我们也可以说 $$ C(a)={\\pi(a) \\ | \\ \\pi \\in G} $$\n如果$A={1,2,3}$\n$\\pi_1=\\left(\\begin{matrix} 1 \u0026 2 \u0026 3 \\newline 1 \u0026 2 \u0026 3 \\end{matrix}\\right)$\n$\\pi_2=\\left(\\begin{matrix} 1 \u0026 2 \u0026 3 \\newline 3 \u0026 2 \u0026 1 \\end{matrix}\\right)$\n$X={\\pi_1, \\pi_2}$,可以验证$G={X,\\circ}$是一个置换群，${1,3}$是一个等价类，${2}$是一个等价类\n可以证明自反、对称、传递是满足的\n3 伯恩赛德引理 这个定理将给出置换群衍生出的等价关系的（不同）等价关系数量的计数方法\n3.1 伯恩赛德引理 假设$G$是一个置换群，$a$是$A$中的元素，如果$\\pi(a)=a$，则称$A$中的元素$a$在置换$\\pi$下是不变的(Invariant)，$Inv(\\pi)$表示不变元素的数量\n定理 假设$G$是一个集合$A$的置换群，设$S$是$G$上衍生出来的等价关系，那么$S$中的等价类的数量由下式给出:\n$$ \\frac{1}{|G|} \\sum_{\\pi\\in G}Inv(\\pi) $$\n$|G|$是置换群中置换的数量，让我们来用一下这个定理，假设$G$下面的置换组成\n$$ \\pi_1=\\left(\\begin{matrix} 1 \u0026 2 \u0026 3 \u0026 4\\newline 1 \u0026 2 \u0026 3 \u0026 4 \\end{matrix}\\right) , \\pi_2=\\left(\\begin{matrix} 1 \u0026 2 \u0026 3 \u0026 4 \\newline 2 \u0026 1 \u0026 3 \u0026 4 \\end{matrix}\\right) , $$\n$$ \\pi_3=\\left(\\begin{matrix} 1 \u0026 2 \u0026 3 \u0026 4\\newline 1 \u0026 2 \u0026 4 \u0026 3 \\end{matrix}\\right) , \\pi_4=\\left(\\begin{matrix} 1 \u0026 2 \u0026 3 \u0026 4 \\newline 2 \u0026 1 \u0026 4 \u0026 3 \\end{matrix}\\right) , $$\n可以看出来，有两个等价类分别是${1,2}$，${3, 4}$，等价类的数量为$2$\n可以验证$Inv(\\pi_1)=4,Inv(\\pi_2)=2,Inv(\\pi_3)=2,Inv(\\pi_4)=0$\n$$ 等价类的数量=\\frac{1}{4}(4+2+2+0)=2 $$\n3.2 伯恩赛德引理的证明 Part 1 这个证明可以跳过，对后面阅读没有什么影响\n对于$A$中的元素$a$，我们可以定义稳定算子(Stabilizer)的概念，$St(a)$是保持元素$a$不变的置换的集合，$St(a)={\\pi \\in G | \\pi(a) = a}$，\n$$ \\pi_1=\\left(\\begin{matrix} 1 \u0026 2 \u0026 3 \\newline 1 \u0026 2 \u0026 3 \\end{matrix}\\right) , \\pi_2=\\left(\\begin{matrix} 1 \u0026 2 \u0026 3 \\newline 2 \u0026 3 \u0026 1 \\end{matrix}\\right) , \\pi_3=\\left(\\begin{matrix} 1 \u0026 2 \u0026 3 \\newline 3 \u0026 1 \u0026 2 \\end{matrix}\\right) , $$ $St(2) = {\\pi_1}$，\n包含$2$的等价类$C(2)={\\pi_1(2),\\pi_2(2),\\pi_3(2)}={1, 2, 3}$\n可以发现$|St(2)| \\times |C(2)| = |G| = 3$，这不是巧合\n引理 假设$G$是一个置换群，而且$a \\in A$，那么， $$ |St(a)| \\times |C(a)| = |G| $$\n让我们来简单证明这个定理\n假设$C(a)={b_1,b_2,\\dotsb, b_r}$，那么存在一个$\\pi_1$，满足$\\pi_1(a)=b_1$，同样存在$\\pi_2(a)=b_2$,$\\dotsb$,设$P={\\pi_1, \\pi_2, \\dotsc, \\pi_r}$，而且$|P|=|C(a)|$，于是转化为证明$|St(a)|\\times |P|=|G|$\n从$G$中选一个置换$\\pi$, $\\pi$一定将$a$置换成一个元素，设该元素为$b_k$，即$\\pi(a)=b_k$，\n另一个方面，$\\pi_k(a)=b_k$,因此$\\pi^{-1}_k \\circ \\pi(a)=a$，即$\\pi^{-1}_k \\circ \\pi \\in St(a)$，\n$$ \\pi_k \\circ (\\pi_k^{-1} \\circ \\pi) = \\pi $$ 这说明$G$中的元素$\\pi$可以由$St(a)$和$C(a)$中的元素合成得到\n然后我们再来说明这是唯一的\n假设$\\pi=\\pi_k\\circ \\gamma=\\pi_l \\circ \\delta$ ，$\\gamma$和$\\delta$都在$St(a)$中，因此$\\pi_k \\circ \\gamma(a)=b_k=\\pi_l \\circ \\delta (a)=b_l$，因此$l=k$，这种组合方式是唯一的，因此$|St(a)| \\times |C(a)| = |G|$\nPart 2 让我们继续证明伯恩赛德引理\n假设$A={1,2,\\dotsc,n}$, $G={\\pi_1, \\pi_2, \\dotsc, \\pi_m}$，让我们看看下面这个式子的是否成立\n$$ |Inv(\\pi_1)|+|Inv(\\pi_2)|+\\dotsb+|Inv(\\pi_m)|=|St(1)|+|St(2)|+\\dotsb+|St(n)| $$\n可以发现都计数的是满足$\\pi(a)=a$序对$\u003c\\pi,a\u003e$的个数，因此等式是成立的\n将等式两边同时除以|G|，左边就得到了伯恩赛德引理的型式，而右边，根据Part1中的引理可以转化为\n$$ \\frac{1}{C(1)}+\\frac{1}{C(2)}+\\dotsb+\\frac{1}{C(n)} \\ \\ \\ \\ (1) $$\n而$C(a)$是一个等价类，两个等价类的交集要么是全集要么是空集，假设$C(a)={b_1,b_2,\\dotsc, b_r}$,那么，\n$$ \\frac{1}{C(b_1)}+\\frac{1}{C(b_2)}+\\dotsb+\\frac{1}{C(b_r)}=\\frac{1}{r}+\\frac{1}{r}+\\dotsb+\\frac{1}{r}=1 $$\n于是(1)式计数的就是等价类的个数\n4 等价着色 伯恩赛德引理和计算等价着色数量有什么关系呢?其实伯恩赛德引理不能直接帮助我们计算等价着色的数量，但是我们可以适当的定义等价关系，然后再计算等价着色的数量\n假设$C(R,D)$使用$R$中的颜色，来给$D$中的元素染色的着色集合，\n假设$R$是黑色和白色，$D$是图中的节点，那么$C(R,D)$是给图中节点染色的集合 $C(R,D)={C_1,C_2,\\dotsb, C_{16}}$\n定义在$C(R,D)$上的置换$\\pi^*$，将一种着色变为另一种着色，更形式一点，假定$f$是一个着色，那么新着色$\\pi^*f$定义为$(\\pi^*f)(a)$是$f(\\pi(a))$\n同样，也可以定义$C(R,D)$上的置换群，$G^={\\pi^ \\ | \\ \\pi \\in G}$，$G$和$G^$的元素数量一样，因为$\\pi$和$\\pi^对应于一种相同旋转$。$G^$也可以衍生出等价关系$S^$，而$S^*$就是我们关注的。\n假设$f,g$是两个着色，如果有一个$\\pi \\in G$($\\pi^\\in G^$)，$\\pi^*f=g$，我们就认为$f,g$是等价的\n我们要求的$S^*$划分出来的等价类的数量\n从上图可以看出来$G^$的大小是$3$，设$G^={\\pi_1^,\\pi_2^,\\pi_3^*}$，分别对应逆时针旋转$0^\\circ,120^\\circ, 240^\\circ$\n$$ \\pi_1^*=\\left(\\begin{matrix} C_1 \u0026 C_2 \u0026 C_3 \u0026 C_4 \u0026C_5 \u0026 C_6 \u0026C_7 \u0026 C_8 \u0026C_9 \u0026 C_{10} \u0026 C_{11} \u0026 C_{12} \u0026 C_{13} \u0026 C_{14} \u0026 C_{15} \u0026 C_{16} \\newline C_1 \u0026 C_2 \u0026 C_3 \u0026 C_4 \u0026C_5 \u0026 C_6 \u0026C_7 \u0026 C_8 \u0026C_9 \u0026 C_{10} \u0026 C_{11} \u0026 C_{12} \u0026 C_{13} \u0026 C_{14} \u0026 C_{15} \u0026 C_{16} \\end{matrix}\\right) $$\n$$ \\pi_2^*=\\left(\\begin{matrix} C_1 \u0026 C_2 \u0026 C_3 \u0026 C_4 \u0026C_5 \u0026 C_6 \u0026C_7 \u0026 C_8 \u0026C_9 \u0026 C_{10} \u0026 C_{11} \u0026 C_{12} \u0026 C_{13} \u0026 C_{14} \u0026 C_{15} \u0026 C_{16} \\newline C_1 \u0026 C_3 \u0026 C_4 \u0026 C_2 \u0026C_5 \u0026 C_8 \u0026C_6 \u0026 C_7 \u0026C_{10} \u0026 C_{11} \u0026 C_{9} \u0026 C_{13} \u0026 C_{14} \u0026 C_{12} \u0026 C_{15} \u0026 C_{16} \\end{matrix}\\right) $$\n$$ \\pi_3^*=\\left(\\begin{matrix} C_1 \u0026 C_2 \u0026 C_3 \u0026 C_4 \u0026C_5 \u0026 C_6 \u0026C_7 \u0026 C_8 \u0026C_9 \u0026 C_{10} \u0026 C_{11} \u0026 C_{12} \u0026 C_{13} \u0026 C_{14} \u0026 C_{15} \u0026 C_{16} \\newline C_1 \u0026 C_4 \u0026 C_2 \u0026 C_3 \u0026C_5 \u0026 C_7 \u0026C_8 \u0026 C_6 \u0026C_{11} \u0026 C_{9} \u0026 C_{10} \u0026 C_{14} \u0026 C_{12} \u0026 C_{13} \u0026 C_{15} \u0026 C_{16} \\end{matrix}\\right) $$\n$Inv(\\pi_1^)=16,Inv(\\pi_2^)=4,Inv(\\pi_2^*)=4$\n根据伯恩赛德引理，\n$$ 等价着色的个数=\\frac{1}{3}(16+4+4)=8 $$ 可以从上图中验证这个结果的正确性，为了与$S$中的等价类区分，我们称$S^*$中等价类为模式\n通过枚举$C(R,D)$中的元素，再枚举$\\pi^$计算$Inv(\\pi^)$过于麻烦，可以直接计算$Inv(\\pi^)$，于是有了下面的定理*\n5 Polya定理的特殊情况 5.1 循环分解 让我们再回到置换，设置换$\\pi_1=\\left(\\begin{matrix} 1 \u0026 2 \u0026 3 \u0026 4 \u0026 5\\newline 2 \u0026 3 \u0026 4 \u0026 5 \u0026 1 \\end{matrix}\\right)$ 让我们不断地重复这个置换，那么可以找到循环节$1\\rightarrow 2 \\rightarrow 3 \\rightarrow 4 \\rightarrow 5 \\rightarrow 1$，那我们就把$\\pi$简写$(12345)$\n再比如$\\pi_2=\\left(\\begin{matrix} 1 \u0026 2 \u0026 3 \u0026 4 \u0026 5 \u0026 6 \\newline 5 \u0026 1 \u0026 6 \u0026 3 \u0026 2 \u0026 4 \\end{matrix}\\right)$ 可以简写成$(152)(364)$，这一过程被称为循环分解\n定义$cyc(\\pi)$是$\\pi$循环分解中循环节的数量，比如$cyc(\\pi_1)=1，cyc(\\pi_2)=2$\n5.2 Polya 计数的特殊情况 定理 假设$G$是集合$D$的置换群，且$C(R,D)$是使用$R$中颜色给$D$中元素染色的集合，$R$中颜色的数量的$m$,$C(R,D)$中不同着色数量($S^*$中等价类的数量)由下式给出：\n$$ \\frac{1}{|G|} (m^{cyc(\\pi_1)}+m^{cyc(\\pi_2)}+\\dotsb+m^{cyc(\\pi_k)}) $$ 其中$G={\\pi_1, \\pi_2, \\dotsb, \\pi_k}$\n让我们用这个定理再算一次等价着色的个数，假定将中间的点记为$1$号 $0^\\circ旋转，\\pi_1=(1)(2)(3)(4)$\n$120^\\circ， \\pi_2=(1)(234)$\n$240^\\circ， \\pi_3=(1)(234)$\n$$ 等价着色的个数=\\frac{1}{3}(2^4+2^2+2^2)=8 $$\n5.3 循环指标$P_G$ 如果可以用一个生成函数来描述一个置换群，那将很有用，这将引出更一般的波利亚计数定理，因此有了循环指标$P_G$的概念\n假设$\\pi=(1)(23)(45)(6)(789)(10)$，可以将他编码为$x_1^3x_2^2x_3$\n可以看出来编码方式，$x_i$代表长度为$i$的循环节，$x_i$的幂次$b$代表有多少个长度为$i$的循环节\n于是可以用每个置换编码的和再除以$|G|$,\n$$ P_G(x_1,x_2,\\dotsc,x_k)=\\frac{1}{G}\\sum_{\\pi\\in G} x_1^{b_1}x_2^{b_2}\\dotsb x_k^{b_k} $$ 来编码一个置换群\n对5.2的例子中的置换群进行编码，$P_G=\\frac{1}{3}(x_1^4+x_1x_3+x_1x_3)$\n而且，波利亚计数的特殊情况就是$P_G$中$x_1,x_2,\\dotsc,x_k$都取$m$的情况\n5.4 Polya计数特殊情况的证明 同样可以跳过这一部分\n将Polya计数特殊情况的公式与伯恩赛德引理对比，因此只要证明$m^{cyc(\\pi)}=Inv(\\pi^*)$\n考虑一个具体的情况，假定$\\pi=(1)(23)(456)(7)$，经过置换2，3的颜色交换，$4,5,6$将颜色给下一个，若$f$是一个着色，要让$\\pi^*(f)=f$，那么$f$在每个循环节中的染色要一致，因此一共有$m^{cyc(\\pi)}$这么多$f$\n6 Polya计数定理 为什么还有这个？\n如果要求必须要用黑色$k$次，或者至少一次黑色，上面的定理就不好用了\n6.1 给颜色加权 假设着色$f$给$D$染色，使用红色$t_1$次，绿色$t_2$次，蓝色$t_3$次\n假定红色的权值$w$为$r$,绿色$g$,蓝色$b$，\n那么着色$f$的权$W(f)=r^{t_1}g^{t_2}b^{t_3}$，而如果染色$f,g$是等价的，那么他们的权是相等的\n于是，我们也可以定义一个着色等价类(模式)的权等于不同等价类的权之和，把这个称为着色等价类（模式）的权，或者模式集合的目录，因为他概括了模式的染色方式\n我们再来考虑5.2中的例子，模式目录是\n$$ w^4+2w^3b+2w^2b^2+2wb^3+b^4 $$\n所有系数之和等于不同等价类的个数，\n如果要求用了2个白色两个黑的着色方案数，可通过$w^2b^2$前的系数得知是2种\n下面的定理将给出计算模式目录的方法\n6.2 Polya定理内容 定理 假设$G$是集合$D$上的置换群，而$C(R,D)$是用$R$中的颜色给$D$着色的集合，$w$是颜色的权值，那么$C(R,D)的着色的模式目录为$：\n$$ P_G\\bigg(\\sum_{r\\in R}w(r),\\sum_{r\\in R}w^2(r),\\dotsb,\\sum_{r\\in R}w^k(r)\\bigg) $$ 其中$P_G(x_1,x_2,\\dotsb,x_k)$是循环指标\n再回到之前的例子\n我们已经知道$P_G=\\frac{1}{3}(x_1^4+x_1x_3+x_1x_3)$\n假定我们用白，黑染色，权值分别为$w,b$\n$$ \\sum_{r\\in R}w(r)=w+b,\\sum_{r\\in R}w^3(r)=w^3+b^3 $$ 带入$P_G$ $$ \\frac{1}{3}[(w+b)^4+2(w+b)(w^3+b^3)] $$\n通过对颜色权值的简单赋值就能的要一些有用的结论\n如果想知道以用有多少种染色模式，那么只要把所有的权值都设为$1$ 如果不想用某一颜色，就把颜色设为$0$，其他颜色设为$1$ 如果想知道用某个颜色$k$次的模式数，就把其他颜色设为$1$，求改颜色权值幂次为$k$前的系数 . . . QAQ, 终于写完了。。。\n","wordCount":"876","inLanguage":"en","image":"https://Anlarry.github.io/cover.png","datePublished":"2020-02-14T00:46:00+08:00","dateModified":"2020-02-14T00:46:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://Anlarry.github.io/posts/acm-icpc/%E6%B3%A2%E9%87%8C%E4%BA%9A%E8%AE%A1%E6%95%B0/"},"publisher":{"@type":"Organization","name":"Hi-^_^","logo":{"@type":"ImageObject","url":"https://Anlarry.github.io/icon/ai512.png"}}}</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://Anlarry.github.io/ accesskey=h title="Jiali's Blog (Alt + H)"><img src=/icon/ai512.png alt=logo aria-label=logo height=35>Jiali's Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://Anlarry.github.io/archives/ title="Archives 📦"><span>Archives 📦</span></a></li><li><a href=https://Anlarry.github.io/categories/ title="Categories 📂"><span>Categories 📂</span></a></li><li><a href=https://Anlarry.github.io/tags/ title="Tags 🏷"><span>Tags 🏷</span></a></li><li><a href=https://Anlarry.github.io/book_reading/ title="Book-Reading 📚"><span>Book-Reading 📚</span></a></li><li><a href=https://Anlarry.github.io/links/ title="Links 🔗"><span>Links 🔗</span></a></li><li><a href=https://Anlarry.github.io/search/ title="Search 🔍 (Alt + /)" accesskey=/><span>Search 🔍</span></a></li></ul></nav></header><main class=main><link rel=stylesheet href=https://Anlarry.github.io/sass/single-main.css><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://Anlarry.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://Anlarry.github.io/posts/>Posts</a></div><h1 class=post-title>波里亚计数</h1><div class=post-meta>📝 February 14, 2020&nbsp;·&nbsp;⌛ 5 min&nbsp;|&nbsp;
<a href=https://github.com/Anlarry/Anlarry.github.io/issues rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#polya%e8%ae%a1%e6%95%b0 aria-label=Polya计数>Polya计数</a><ul><li><a href=#1-%e7%ad%89%e4%bb%b7%e5%85%b3%e7%b3%bb aria-label="1 等价关系">1 等价关系</a><ul><li><a href=#11-%e7%ad%89%e4%bb%b7%e5%85%b3%e7%b3%bb%e7%9a%84%e5%ae%9a%e4%b9%89 aria-label="1.1 等价关系的定义">1.1 等价关系的定义</a></li><li><a href=#12-%e7%ad%89%e4%bb%b7%e7%b1%bb aria-label="1.2 等价类">1.2 等价类</a></li></ul></li><li><a href=#2-%e7%bd%ae%e6%8d%a2%e7%be%a4 aria-label="2 置换群">2 置换群</a><ul><li><a href=#21-%e7%bd%ae%e6%8d%a2%e7%be%a4%e7%9a%84%e5%ae%9a%e4%b9%89 aria-label="2.1 置换群的定义">2.1 置换群的定义</a></li><li><a href=#22-%e7%bd%ae%e6%8d%a2%e7%be%a4%e8%a1%8d%e7%94%9f%e7%9a%84%e7%ad%89%e4%bb%b7%e5%85%b3%e7%b3%bb aria-label="2.2 置换群衍生的等价关系">2.2 置换群衍生的等价关系</a></li></ul></li><li><a href=#3-%e4%bc%af%e6%81%a9%e8%b5%9b%e5%be%b7%e5%bc%95%e7%90%86 aria-label="3 伯恩赛德引理">3 伯恩赛德引理</a><ul><li><a href=#31-%e4%bc%af%e6%81%a9%e8%b5%9b%e5%be%b7%e5%bc%95%e7%90%86 aria-label="3.1 伯恩赛德引理">3.1 伯恩赛德引理</a></li><li><a href=#32-%e4%bc%af%e6%81%a9%e8%b5%9b%e5%be%b7%e5%bc%95%e7%90%86%e7%9a%84%e8%af%81%e6%98%8e aria-label="3.2 伯恩赛德引理的证明">3.2 伯恩赛德引理的证明</a><ul><li><a href=#part-1 aria-label="Part 1">Part 1</a></li><li><a href=#part-2 aria-label="Part 2">Part 2</a></li></ul></li></ul></li><li><a href=#4-%e7%ad%89%e4%bb%b7%e7%9d%80%e8%89%b2 aria-label="4 等价着色">4 等价着色</a></li><li><a href=#5-polya%e5%ae%9a%e7%90%86%e7%9a%84%e7%89%b9%e6%ae%8a%e6%83%85%e5%86%b5 aria-label="5 Polya定理的特殊情况">5 Polya定理的特殊情况</a><ul><li><a href=#51-%e5%be%aa%e7%8e%af%e5%88%86%e8%a7%a3 aria-label="5.1 循环分解">5.1 循环分解</a></li><li><a href=#52-polya-%e8%ae%a1%e6%95%b0%e7%9a%84%e7%89%b9%e6%ae%8a%e6%83%85%e5%86%b5 aria-label="5.2 Polya 计数的特殊情况">5.2 Polya 计数的特殊情况</a></li><li><a href=#53-%e5%be%aa%e7%8e%af%e6%8c%87%e6%a0%87p_g aria-label="5.3 循环指标$P_G$">5.3 循环指标$P_G$</a></li><li><a href=#54-polya%e8%ae%a1%e6%95%b0%e7%89%b9%e6%ae%8a%e6%83%85%e5%86%b5%e7%9a%84%e8%af%81%e6%98%8e aria-label="5.4 Polya计数特殊情况的证明">5.4 Polya计数特殊情况的证明</a></li></ul></li><li><a href=#6-polya%e8%ae%a1%e6%95%b0%e5%ae%9a%e7%90%86 aria-label="6 Polya计数定理">6 Polya计数定理</a><ul><li><a href=#61-%e7%bb%99%e9%a2%9c%e8%89%b2%e5%8a%a0%e6%9d%83 aria-label="6.1 给颜色加权">6.1 给颜色加权</a></li><li><a href=#62-polya%e5%ae%9a%e7%90%86%e5%86%85%e5%ae%b9 aria-label="6.2 Polya定理内容">6.2 Polya定理内容</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><h1 id=polya计数>Polya计数<a hidden class=anchor aria-hidden=true href=#polya计数>#</a></h1><blockquote><p>将波利亚计数定理整理在这里，作为一个总结和介绍，也方便以后复习</p></blockquote><p><strong>为什么学习Polya计数定理</strong></p><p>通过Polya计数定理，我们可以计算等价类的数量，比如下面这个问题：</p><p><em>用$m$种颜色给一个正方形染色，如果正方形可以自由转动，求染色方案数</em></p><blockquote><p>让我们从一些概念开始</p></blockquote><h2 id=1-等价关系>1 等价关系<a hidden class=anchor aria-hidden=true href=#1-等价关系>#</a></h2><h3 id=11-等价关系的定义>1.1 等价关系的定义<a hidden class=anchor aria-hidden=true href=#11-等价关系的定义>#</a></h3><p>假设$V$是一个集合，$S$是定义在$V$上的一个关系，若$S$有如下性质：</p><ul><li>自反性</li><li>传递性</li><li>对称性</li></ul><p>那么， $S$就是一个等价关系</p><p>$a$和$b$有关系$S$,可以记为$aSb$</p><blockquote><p>假设定义关系$S$，图形$a$可以旋转得到$b$ $\Leftrightarrow$ $aSb$<br>例如图中的$方块_1$和$方块_2$具有关系$S$，即他们可以通过旋转得到彼此，而$方块_1$和$方块_2$则没有关系$S$<br><img src=1.1.png alt></p></blockquote><h3 id=12-等价类>1.2 等价类<a hidden class=anchor aria-hidden=true href=#12-等价类>#</a></h3><p>通过上图，可以看出来：$方块_1$和$方块_2$是同一类的，而$方块_1$和$方块_2$则是另外两类，于是可以想到集合$V$上的等价关系$S$将集合的元素划分到不同的类中，我们把它称为等价类</p><p>而包含元素$a$的等价类则是由满足$aSb$的所有元素$b$组成的(当然也包含元素$a$),即$C(a)={b\in V | \ aSb}$</p><p>仔细想一想，不难发现<strong>两个不同等价类是不相交的</strong></p><h2 id=2-置换群>2 置换群<a hidden class=anchor aria-hidden=true href=#2-置换群>#</a></h2><h3 id=21-置换群的定义>2.1 置换群的定义<a hidden class=anchor aria-hidden=true href=#21-置换群的定义>#</a></h3><p>假设$A={1,2,\dotsc, n}$，通过置换，将$A$中的元素重新排列，得到另一个排列$a_1, a_2, \dotsc, a_n$，可以把这个过程写成</p><p>$$
\left (
\begin{matrix}
1 & 2 & \dotsc & n \newline
a_1 & a_2 & \dotsc & a_n
\end{matrix}
\right )
$$</p><p>所以，可以将置换看成一个双射函数$f:{1,2,\dotsc, n} \rightarrow {1,2,\dotsc, n}$</p><p>置换之间也可进行<strong>合成</strong>运算</p><blockquote><p>$$
\pi_1 = \left (
\begin{matrix}
1 & 2 & 3 & 4 \newline
4 & 2 & 1 & 3
\end{matrix}
\right ) \ \
\pi_2 = \left (
\begin{matrix}
1 & 2 & 3 & 4 \newline
2 & 1 & 4 & 3
\end{matrix}
\right )
$$<br>$$
\pi_1 \circ \pi_2 =\left (
\begin{matrix}
1 & 2 & 3 & 4 \newline
2 & 4 & 3 & 1
\end{matrix}
\right )
$$
$\pi_1 \circ \pi_2 (1) = \pi_1(\pi_2(1))=2$</p></blockquote><p>而在置换集合$X$上定义的群则称为置换群，置换群也是群也要满足群的性 质</p><ul><li>运算封闭 $\pi_1 \in X, \pi_2 \in X \Rightarrow \pi_1 \circ \pi_2 \in X$</li><li>满足结合律</li><li>有单位元，置换$I(a)=a$</li><li>有逆元，$\pi \circ \pi^{-1} = I$</li></ul><p>但是置换与计算不同染色模式数量有什么关系？图形的旋转等变换都可以用一个只置换来表示</p><p>我们把1-4按顺时针放到正方形的四个方块中</p><blockquote><p><img src=2.1-1.png alt><br>$\pi_1=\left(\begin{matrix}
1 & 2 & 3 & 4 \newline
1 & 2 & 3 & 4
\end{matrix}\right)$</p></blockquote><p>旋转$90^\circ$</p><blockquote><p><img src=2.1-2.png alt>
$\pi_2=\left(\begin{matrix}
1 & 2 & 3 & 4 \newline
4 & 1 & 2 & 3
\end{matrix}\right)$</p></blockquote><h3 id=22-置换群衍生的等价关系>2.2 置换群衍生的等价关系<a hidden class=anchor aria-hidden=true href=#22-置换群衍生的等价关系>#</a></h3><p>假设$G=(X,\circ)$，通过置换$\pi\in X$，元素$a$可以被置换为其他元素$\pi(a)=b$，可以发现这里也存在一种等价关系， 可以定义等价关系$S$:</p><p>$$
aSb \Leftrightarrow \exist \pi \in G, \pi(a)=b
$$</p><blockquote><p>$\pi \in G 也可以来表示 \pi \in X$</p></blockquote><p>而包含$a$的等价类$C(a)$是由所有满足$aSb$的元素$b$组成的，因此我们也可以说
$$
C(a)={\pi(a) \ | \ \pi \in G}
$$</p><blockquote><p>如果$A={1,2,3}$<br>$\pi_1=\left(\begin{matrix}
1 & 2 & 3 \newline
1 & 2 & 3
\end{matrix}\right)$<br>$\pi_2=\left(\begin{matrix}
1 & 2 & 3 \newline
3 & 2 & 1
\end{matrix}\right)$<br>$X={\pi_1, \pi_2}$,可以验证$G={X,\circ}$是一个置换群，${1,3}$是一个等价类，${2}$是一个等价类</p></blockquote><p>可以证明自反、对称、传递是满足的</p><h2 id=3-伯恩赛德引理>3 伯恩赛德引理<a hidden class=anchor aria-hidden=true href=#3-伯恩赛德引理>#</a></h2><blockquote><p>这个定理将给出置换群衍生出的等价关系的（不同）等价关系数量的计数方法</p></blockquote><h3 id=31-伯恩赛德引理>3.1 伯恩赛德引理<a hidden class=anchor aria-hidden=true href=#31-伯恩赛德引理>#</a></h3><p><em>假设$G$是一个置换群，$a$是$A$中的元素，如果$\pi(a)=a$，则称$A$中的元素$a$在置换$\pi$下是<strong>不变的</strong>(Invariant)，$Inv(\pi)$表示不变元素的数量</em></p><p><strong>定理</strong>   假设$G$是一个集合$A$的置换群，设$S$是$G$上衍生出来的等价关系，那么$S$中的等价类的数量由下式给出:</p><p>$$
\frac{1}{|G|} \sum_{\pi\in G}Inv(\pi)
$$</p><p>$|G|$是置换群中置换的数量，让我们来用一下这个定理，假设$G$下面的置换组成</p><p>$$
\pi_1=\left(\begin{matrix}
1 & 2 & 3 & 4\newline
1 & 2 & 3 & 4
\end{matrix}\right) ,
\pi_2=\left(\begin{matrix}
1 & 2 & 3 & 4 \newline
2 & 1 & 3 & 4
\end{matrix}\right) ,
$$</p><p>$$
\pi_3=\left(\begin{matrix}
1 & 2 & 3 & 4\newline
1 & 2 & 4 & 3
\end{matrix}\right) ,
\pi_4=\left(\begin{matrix}
1 & 2 & 3 & 4 \newline
2 & 1 & 4 & 3
\end{matrix}\right) ,
$$</p><p>可以看出来，有两个等价类分别是${1,2}$，${3, 4}$，等价类的数量为$2$</p><p>可以验证$Inv(\pi_1)=4,Inv(\pi_2)=2,Inv(\pi_3)=2,Inv(\pi_4)=0$</p><p>$$
等价类的数量=\frac{1}{4}(4+2+2+0)=2
$$</p><h3 id=32-伯恩赛德引理的证明>3.2 伯恩赛德引理的证明<a hidden class=anchor aria-hidden=true href=#32-伯恩赛德引理的证明>#</a></h3><h4 id=part-1>Part 1<a hidden class=anchor aria-hidden=true href=#part-1>#</a></h4><p><em>这个证明可以跳过，对后面阅读没有什么影响</em></p><p>对于$A$中的元素$a$，我们可以定义<strong>稳定算子</strong>(Stabilizer)的概念，$St(a)$是保持元素$a$不变的置换的集合，$St(a)={\pi \in G | \pi(a) = a}$，</p><blockquote><p>$$
\pi_1=\left(\begin{matrix}
1 & 2 & 3 \newline
1 & 2 & 3
\end{matrix}\right) ,
\pi_2=\left(\begin{matrix}
1 & 2 & 3 \newline
2 & 3 & 1
\end{matrix}\right) ,
\pi_3=\left(\begin{matrix}
1 & 2 & 3 \newline
3 & 1 & 2
\end{matrix}\right) ,
$$
$St(2) = {\pi_1}$，<br>包含$2$的等价类$C(2)={\pi_1(2),\pi_2(2),\pi_3(2)}={1, 2, 3}$</p></blockquote><p>可以发现$|St(2)| \times |C(2)| = |G| = 3$，这不是巧合</p><p><strong>引理</strong>   假设$G$是一个置换群，而且$a \in A$，那么，
$$
|St(a)| \times |C(a)| = |G|
$$</p><p>让我们来简单证明这个定理</p><p>假设$C(a)={b_1,b_2,\dotsb, b_r}$，那么存在一个$\pi_1$，满足$\pi_1(a)=b_1$，同样存在$\pi_2(a)=b_2$,$\dotsb$,设$P={\pi_1, \pi_2, \dotsc, \pi_r}$，而且$|P|=|C(a)|$，于是转化为证明$|St(a)|\times |P|=|G|$</p><p>从$G$中选一个置换$\pi$, $\pi$一定将$a$置换成一个元素，设该元素为$b_k$，即$\pi(a)=b_k$，</p><p>另一个方面，$\pi_k(a)=b_k$,因此$\pi^{-1}_k \circ \pi(a)=a$，即$\pi^{-1}_k \circ \pi \in St(a)$，</p><p>$$
\pi_k \circ (\pi_k^{-1} \circ \pi) = \pi
$$
这说明$G$中的元素$\pi$可以由$St(a)$和$C(a)$中的元素合成得到</p><p>然后我们再来说明这是唯一的</p><p>假设$\pi=\pi_k\circ \gamma=\pi_l \circ \delta$ ，$\gamma$和$\delta$都在$St(a)$中，因此$\pi_k \circ \gamma(a)=b_k=\pi_l \circ \delta (a)=b_l$，因此$l=k$，这种组合方式是唯一的，因此$|St(a)| \times |C(a)| = |G|$</p><h4 id=part-2>Part 2<a hidden class=anchor aria-hidden=true href=#part-2>#</a></h4><p>让我们继续证明伯恩赛德引理</p><p>假设$A={1,2,\dotsc,n}$, $G={\pi_1, \pi_2, \dotsc, \pi_m}$，让我们看看下面这个式子的是否成立</p><p>$$
|Inv(\pi_1)|+|Inv(\pi_2)|+\dotsb+|Inv(\pi_m)|=|St(1)|+|St(2)|+\dotsb+|St(n)|
$$</p><p>可以发现都计数的是满足$\pi(a)=a$序对$&lt;\pi,a>$的个数，因此等式是成立的</p><p>将等式两边同时除以|G|，左边就得到了伯恩赛德引理的型式，而右边，根据<strong>Part1</strong>中的引理可以转化为</p><p>$$
\frac{1}{C(1)}+\frac{1}{C(2)}+\dotsb+\frac{1}{C(n)} \ \ \ \ (1)
$$</p><p>而$C(a)$是一个等价类，两个等价类的交集要么是全集要么是空集，假设$C(a)={b_1,b_2,\dotsc, b_r}$,那么，</p><p>$$
\frac{1}{C(b_1)}+\frac{1}{C(b_2)}+\dotsb+\frac{1}{C(b_r)}=\frac{1}{r}+\frac{1}{r}+\dotsb+\frac{1}{r}=1
$$</p><p>于是(1)式计数的就是等价类的个数</p><h2 id=4-等价着色>4 等价着色<a hidden class=anchor aria-hidden=true href=#4-等价着色>#</a></h2><p>伯恩赛德引理和计算等价着色数量有什么关系呢?其实伯恩赛德引理不能直接帮助我们计算等价着色的数量，但是我们可以适当的定义等价关系，然后再计算等价着色的数量</p><p>假设$C(R,D)$使用$R$中的颜色，来给$D$中的元素染色的着色集合，</p><blockquote><p>假设$R$是黑色和白色，$D$是图中的节点，那么$C(R,D)$是给图中节点染色的集合
<img src=4-1.png alt>
$C(R,D)={C_1,C_2,\dotsb, C_{16}}$</p></blockquote><p>定义在$C(R,D)$上的置换$\pi^*$，将一种着色变为另一种着色，更形式一点，假定$f$是一个着色，那么新着色$\pi^*f$定义为$(\pi^*f)(a)$是$f(\pi(a))$</p><p>同样，也可以定义$C(R,D)$上的置换群，$G^<em>={\pi^</em> \ | \ \pi \in G}$，$G$和$G^<em>$的元素数量一样，因为$\pi$和$\pi^<em>对应于一种相同旋转$。$G^</em>$也可以衍生出等价关系$S^</em>$，而$S^*$就是我们关注的。</p><p>假设$f,g$是两个着色，如果有一个$\pi \in G$($\pi^<em>\in G^</em>$)，$\pi^*f=g$，我们就认为$f,g$是等价的</p><p>我们要求的$S^*$划分出来的等价类的数量</p><p>从上图可以看出来$G^<em>$的大小是$3$，设$G^</em>={\pi_1^<em>,\pi_2^</em>,\pi_3^*}$，分别对应逆时针旋转$0^\circ,120^\circ, 240^\circ$</p><p>$$
\pi_1^*=\left(\begin{matrix}
C_1 & C_2 & C_3 & C_4 &C_5 & C_6 &C_7 & C_8 &C_9 & C_{10} & C_{11} & C_{12} & C_{13} & C_{14} & C_{15} & C_{16} \newline
C_1 & C_2 & C_3 & C_4 &C_5 & C_6 &C_7 & C_8 &C_9 & C_{10} & C_{11} & C_{12} & C_{13} & C_{14} & C_{15} & C_{16}
\end{matrix}\right)
$$</p><p>$$
\pi_2^*=\left(\begin{matrix}
C_1 & C_2 & C_3 & C_4 &C_5 & C_6 &C_7 & C_8 &C_9 & C_{10} & C_{11} & C_{12} & C_{13} & C_{14} & C_{15} & C_{16} \newline
C_1 & C_3 & C_4 & C_2 &C_5 & C_8 &C_6 & C_7 &C_{10} & C_{11} & C_{9} & C_{13} & C_{14} & C_{12} & C_{15} & C_{16}
\end{matrix}\right)
$$</p><p>$$
\pi_3^*=\left(\begin{matrix}
C_1 & C_2 & C_3 & C_4 &C_5 & C_6 &C_7 & C_8 &C_9 & C_{10} & C_{11} & C_{12} & C_{13} & C_{14} & C_{15} & C_{16} \newline
C_1 & C_4 & C_2 & C_3 &C_5 & C_7 &C_8 & C_6 &C_{11} & C_{9} & C_{10} & C_{14} & C_{12} & C_{13} & C_{15} & C_{16}
\end{matrix}\right)
$$</p><p>$Inv(\pi_1^<em>)=16,Inv(\pi_2^</em>)=4,Inv(\pi_2^*)=4$</p><p>根据伯恩赛德引理，</p><p>$$
等价着色的个数=\frac{1}{3}(16+4+4)=8
$$
可以从上图中验证这个结果的正确性，为了与$S$中的等价类区分，我们称$S^*$中等价类为<strong>模式</strong></p><p><em>通过枚举$C(R,D)$中的元素，再枚举$\pi^</em>$计算$Inv(\pi^<em>)$过于麻烦，可以直接计算$Inv(\pi^</em>)$，于是有了下面的定理*</p><h2 id=5-polya定理的特殊情况>5 Polya定理的特殊情况<a hidden class=anchor aria-hidden=true href=#5-polya定理的特殊情况>#</a></h2><h3 id=51-循环分解>5.1 循环分解<a hidden class=anchor aria-hidden=true href=#51-循环分解>#</a></h3><p>让我们再回到置换，设置换$\pi_1=\left(\begin{matrix}
1 & 2 & 3 & 4 & 5\newline
2 & 3 & 4 & 5 & 1
\end{matrix}\right)$
让我们不断地重复这个置换，那么可以找到循环节$1\rightarrow 2 \rightarrow 3 \rightarrow 4 \rightarrow 5 \rightarrow 1$，那我们就把$\pi$简写$(12345)$</p><p>再比如$\pi_2=\left(\begin{matrix}
1 & 2 & 3 & 4 & 5 & 6 \newline
5 & 1 & 6 & 3 & 2 & 4
\end{matrix}\right)$
可以简写成$(152)(364)$，这一过程被称为循环分解</p><p>定义$cyc(\pi)$是$\pi$循环分解中循环节的数量，比如$cyc(\pi_1)=1，cyc(\pi_2)=2$</p><h3 id=52-polya-计数的特殊情况>5.2 Polya 计数的特殊情况<a hidden class=anchor aria-hidden=true href=#52-polya-计数的特殊情况>#</a></h3><p><strong>定理</strong>   假设$G$是集合$D$的置换群，且$C(R,D)$是使用$R$中颜色给$D$中元素染色的集合，$R$中颜色的数量的$m$,$C(R,D)$中不同着色数量($S^*$中等价类的数量)由下式给出：</p><p>$$
\frac{1}{|G|} (m^{cyc(\pi_1)}+m^{cyc(\pi_2)}+\dotsb+m^{cyc(\pi_k)})
$$
其中$G={\pi_1, \pi_2, \dotsb, \pi_k}$</p><blockquote><p>让我们用这个定理再算一次等价着色的个数，假定将中间的点记为$1$号
<img src=4-1.png alt>
$0^\circ旋转，\pi_1=(1)(2)(3)(4)$<br>$120^\circ， \pi_2=(1)(234)$<br>$240^\circ， \pi_3=(1)(234)$</p><p>$$
等价着色的个数=\frac{1}{3}(2^4+2^2+2^2)=8
$$</p></blockquote><h3 id=53-循环指标p_g>5.3 循环指标$P_G$<a hidden class=anchor aria-hidden=true href=#53-循环指标p_g>#</a></h3><p>如果可以用一个生成函数来描述一个置换群，那将很有用，这将引出更一般的波利亚计数定理，因此有了循环指标$P_G$的概念</p><p>假设$\pi=(1)(23)(45)(6)(789)(10)$，可以将他编码为$x_1^3x_2^2x_3$</p><p>可以看出来编码方式，$x_i$代表长度为$i$的循环节，$x_i$的幂次$b$代表有多少个长度为$i$的循环节</p><p>于是可以用每个置换编码的和再除以$|G|$,</p><p>$$
P_G(x_1,x_2,\dotsc,x_k)=\frac{1}{G}\sum_{\pi\in G} x_1^{b_1}x_2^{b_2}\dotsb x_k^{b_k}
$$
来编码一个置换群</p><p>对5.2的例子中的置换群进行编码，$P_G=\frac{1}{3}(x_1^4+x_1x_3+x_1x_3)$</p><p>而且，波利亚计数的特殊情况就是$P_G$中$x_1,x_2,\dotsc,x_k$都取$m$的情况</p><h3 id=54-polya计数特殊情况的证明>5.4 Polya计数特殊情况的证明<a hidden class=anchor aria-hidden=true href=#54-polya计数特殊情况的证明>#</a></h3><p><em>同样可以跳过这一部分</em></p><p>将Polya计数特殊情况的公式与伯恩赛德引理对比，因此只要证明$m^{cyc(\pi)}=Inv(\pi^*)$</p><p>考虑一个具体的情况，假定$\pi=(1)(23)(456)(7)$，经过置换2，3的颜色交换，$4,5,6$将颜色给下一个，若$f$是一个着色，要让$\pi^*(f)=f$，那么$f$<strong>在每个循环节中的染色要一致</strong>，因此一共有$m^{cyc(\pi)}$这么多$f$</p><h2 id=6-polya计数定理>6 Polya计数定理<a hidden class=anchor aria-hidden=true href=#6-polya计数定理>#</a></h2><blockquote><p>为什么还有这个？<br>如果要求必须要用黑色$k$次，或者至少一次黑色，上面的定理就不好用了</p></blockquote><h3 id=61-给颜色加权>6.1 给颜色加权<a hidden class=anchor aria-hidden=true href=#61-给颜色加权>#</a></h3><p>假设着色$f$给$D$染色，使用红色$t_1$次，绿色$t_2$次，蓝色$t_3$次</p><p>假定红色的权值$w$为$r$,绿色$g$,蓝色$b$，</p><p>那么着色$f$的权$W(f)=r^{t_1}g^{t_2}b^{t_3}$，而如果染色$f,g$是等价的，那么他们的权是相等的</p><p>于是，我们也可以定义一个着色等价类(模式)的权等于不同等价类的权之和，把这个称为<strong>着色等价类（模式）的权</strong>，或者<strong>模式集合的目录</strong>，因为他概括了模式的染色方式</p><p>我们再来考虑5.2中的例子，模式目录是</p><p>$$
w^4+2w^3b+2w^2b^2+2wb^3+b^4
$$</p><p>所有系数之和等于不同等价类的个数，</p><p>如果要求用了2个白色两个黑的着色方案数，可通过$w^2b^2$前的系数得知是2种</p><p>下面的定理将给出计算模式目录的方法</p><h3 id=62-polya定理内容>6.2 Polya定理内容<a hidden class=anchor aria-hidden=true href=#62-polya定理内容>#</a></h3><p><strong>定理</strong>   假设$G$是集合$D$上的置换群，而$C(R,D)$是用$R$中的颜色给$D$着色的集合，$w$是颜色的权值，那么$C(R,D)的着色的模式目录为$：</p><p>$$
P_G\bigg(\sum_{r\in R}w(r),\sum_{r\in R}w^2(r),\dotsb,\sum_{r\in R}w^k(r)\bigg)
$$
其中$P_G(x_1,x_2,\dotsb,x_k)$是循环指标</p><blockquote><p>再回到之前的例子<br>我们已经知道$P_G=\frac{1}{3}(x_1^4+x_1x_3+x_1x_3)$<br>假定我们用白，黑染色，权值分别为$w,b$<br>$$
\sum_{r\in R}w(r)=w+b,\sum_{r\in R}w^3(r)=w^3+b^3
$$
带入$P_G$
$$
\frac{1}{3}[(w+b)^4+2(w+b)(w^3+b^3)]
$$</p></blockquote><p>通过对颜色权值的简单赋值就能的要一些有用的结论</p><ul><li>如果想知道以用有多少种染色模式，那么只要把所有的权值都设为$1$</li><li>如果不想用某一颜色，就把颜色设为$0$，其他颜色设为$1$</li><li>如果想知道用某个颜色$k$次的模式数，就把其他颜色设为$1$，求改颜色权值幂次为$k$前的系数</li><li>. . .</li></ul><p>QAQ, 终于写完了。。。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://Anlarry.github.io/tags/polya/>POLYA</a></li><li><a href=https://Anlarry.github.io/tags/%E6%90%AC%E5%AE%B6/>搬家</a></li></ul><nav class=paginav><a class=prev href=https://Anlarry.github.io/posts/acm-icpc/codechef-primedst/><span class=title>« Prev Page</span><br><span>CodeChef - PRIMEDST</span></a>
<a class=next href=https://Anlarry.github.io/posts/acm-icpc/rock-paper-scissors-lizard-spock/><span class=title>Next Page »</span><br><span>Rock Paper Scissors Lizard Spock</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://Anlarry.github.io/>Jiali Wang</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="📄";function s(){t.innerText="✔",setTimeout(()=>{t.innerText="📄"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>